<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>2026 新年賀卡 - 陳麒安AI製作</title>
    <!-- 引入 Three.js 用於 3D 渲染 -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <!-- 引入 Tailwind CSS 用於 UI 佈局 -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Serif+TC:wght@400;900&display=swap');

        body {
            margin: 0;
            overflow: hidden;
            background: #050505;
            font-family: 'Noto Serif TC', serif;
            color: #d4af37;
        }

        #canvas-container {
            position: fixed;
            inset: 0;
            z-index: 1;
        }

        /* UI 層級樣式 */
        .ui-layer {
            position: fixed;
            inset: 0;
            z-index: 100;
            pointer-events: none;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: space-between;
            padding: 4rem 1rem;
        }

        .interactive { pointer-events: auto; }

        /* 金色風格按鈕 */
        .gate-btn {
            background: rgba(184, 15, 10, 0.2);
            border: 2px solid #d4af37;
            color: #d4af37;
            padding: 1.2rem 3rem;
            font-size: 1.2rem;
            font-weight: 900;
            letter-spacing: 0.3rem;
            backdrop-filter: blur(8px);
            transition: all 0.4s cubic-bezier(0.165, 0.84, 0.44, 1);
            cursor: pointer;
            border-radius: 4px;
        }

        .gate-btn:hover {
            background: #d4af37;
            color: #4a0404;
            transform: scale(1.05);
        }

        /* 吉祥話顯示動畫 */
        #blessing-display {
            font-size: 3rem;
            font-weight: 900;
            letter-spacing: 0.8rem;
            text-shadow: 0 0 30px rgba(212, 175, 55, 0.6);
            opacity: 0;
            transform: translateY(30px);
            transition: all 0.8s cubic-bezier(0.23, 1, 0.32, 1);
            color: #f4f1ea;
        }

        #blessing-display.active {
            opacity: 1;
            transform: translateY(0);
        }

        .maker-info {
            font-size: 0.8rem;
            letter-spacing: 0.4rem;
            opacity: 0.6;
            color: #d4af37;
        }

        .progress-indicator {
            position: absolute;
            top: 2rem;
            font-size: 0.7rem;
            letter-spacing: 0.2rem;
            opacity: 0.5;
        }
    </style>
</head>
<body>

    <!-- 3D 畫布容器 -->
    <div id="canvas-container"></div>

    <!-- 使用介面層 -->
    <div class="ui-layer">
        <div class="progress-indicator" id="progress">進度 0 / 10</div>
        
        <div class="text-center">
            <div id="blessing-display">開門見喜</div>
        </div>

        <div class="flex flex-col items-center">
            <button id="main-action" class="gate-btn interactive" onclick="openNextDoor()">開啟新歲</button>
        </div>

        <div class="maker-info">陳麒安|AI 製作</div>
    </div>

    <script>
        let scene, camera, renderer, doors = [];
        let currentIdx = 0;
        let isAnimating = false;

        // 核心吉祥話數組
        const blessings = [
            "一元復始", "二全其美", "三陽開泰", "四季平安", "五福臨門",
            "六六大順", "七星高照", "八方來財", "九九同心", "十全十美"
        ];

        // 初始化 3D 場景
        function init() {
            scene = new THREE.Scene();
            // 設置霧氣增加深度感
            scene.fog = new THREE.Fog(0x050505, 5, 45);

            camera = new THREE.PerspectiveCamera(70, window.innerWidth / window.innerHeight, 0.1, 1000);
            camera.position.z = 5;

            renderer = new THREE.WebGLRenderer({ antialias: true });
            renderer.setSize(window.innerWidth, window.innerHeight);
            renderer.setPixelRatio(window.devicePixelRatio);
            document.getElementById('canvas-container').appendChild(renderer.domElement);

            // 設置環境光源與點光源
            const ambient = new THREE.AmbientLight(0xffffff, 0.3);
            scene.add(ambient);

            const pointLight = new THREE.PointLight(0xd4af37, 1.5, 50);
            pointLight.position.set(0, 10, 10);
            scene.add(pointLight);

            // 生成門扉，總共 10 扇
            for (let i = 0; i <= blessings.length; i++) {
                createDoor(i);
            }

            animate();
        }

        // 創建單扇門扉的函數
        function createDoor(index) {
            const group = new THREE.Group();
            const zPos = -index * 15;

            // 門框模型
            const frameGeo = new THREE.BoxGeometry(10.5, 15.5, 0.6);
            const frameMat = new THREE.MeshStandardMaterial({ color: 0x111111, metalness: 0.9, roughness: 0.1 });
            const frame = new THREE.Mesh(frameGeo, frameMat);
            group.add(frame);
            
            // 門板材質設置（紅色系交替）
            const doorGeo = new THREE.BoxGeometry(5.2, 15, 0.4);
            const doorMat = new THREE.MeshStandardMaterial({ 
                color: index % 2 === 0 ? 0x6e0d0d : 0x3d0a0a,
                metalness: 0.4,
                roughness: 0.3
            });

            // 左側門板組件
            const leftGroup = new THREE.Group();
            const leftDoor = new THREE.Mesh(doorGeo, doorMat);
            leftDoor.position.x = 2.6; // 偏移中心以便旋轉
            leftGroup.add(leftDoor);
            leftGroup.position.x = -5.2;

            // 右側門板組件
            const rightGroup = new THREE.Group();
            const rightDoor = new THREE.Mesh(doorGeo, doorMat);
            rightDoor.position.x = -2.6;
            rightGroup.add(rightDoor);
            rightGroup.position.x = 5.2;

            // 門縫金色裝飾條
            const trimGeo = new THREE.BoxGeometry(0.05, 15, 0.5);
            const trimMat = new THREE.MeshBasicMaterial({ color: 0xd4af37 });
            const trimL = new THREE.Mesh(trimGeo, trimMat); trimL.position.x = 5.15;
            leftGroup.add(trimL);
            const trimR = new THREE.Mesh(trimGeo, trimMat); trimR.position.x = -5.15;
            rightGroup.add(trimR);

            group.add(leftGroup);
            group.add(rightGroup);
            group.position.set(0, 0, zPos);
            scene.add(group);

            doors.push({ group, left: leftGroup, right: rightGroup });
        }

        // 觸發下一扇門的邏輯
        function openNextDoor() {
            if (isAnimating || currentIdx >= blessings.length) return;
            isAnimating = true;

            const door = doors[currentIdx];
            const display = document.getElementById('blessing-display');
            const progress = document.getElementById('progress');
            const actionBtn = document.getElementById('main-action');

            display.classList.remove('active');

            setTimeout(() => {
                display.innerText = blessings[currentIdx];
                display.classList.add('active');
                progress.innerText = `進度 ${currentIdx + 1} / 10`;
                if (currentIdx === blessings.length - 1) {
                    actionBtn.innerText = "十全十美";
                } else {
                    actionBtn.innerText = "更進一步";
                }
            }, 400);

            // 平滑推進動畫
            const startZ = camera.position.z;
            const endZ = -((currentIdx + 1) * 15) + 5;
            const duration = 2200;
            const startTime = performance.now();

            function step(now) {
                const elapsed = now - startTime;
                const p = Math.min(elapsed / duration, 1);
                const eased = 1 - Math.pow(1 - p, 4); // Quartic Ease Out 動畫曲線

                // 旋轉開門動畫
                door.left.rotation.y = -eased * Math.PI * 0.75;
                door.right.rotation.y = eased * Math.PI * 0.75;

                // 相機前進動畫
                camera.position.z = startZ + (endZ - startZ) * eased;

                if (p < 1) {
                    requestAnimationFrame(step);
                } else {
                    currentIdx++;
                    isAnimating = false;
                }
            }
            requestAnimationFrame(step);
        }

        // 動畫循環
        function animate() {
            requestAnimationFrame(animate);
            // 鏡頭輕微呼吸晃動增加生動感
            camera.position.y = Math.sin(Date.now() * 0.001) * 0.15;
            camera.position.x = Math.cos(Date.now() * 0.0008) * 0.1;
            renderer.render(scene, camera);
        }

        // 視窗大小調整監聽
        window.addEventListener('resize', () => {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        });

        // 啟動程序
        init();
    </script>
</body>
</html>

